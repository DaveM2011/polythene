{"version":3,"sources":["../../src/src/common/transition.js"],"names":["SHOW_DURATION","HIDE_DURATION","SHOW_DELAY","HIDE_DELAY","TRANSITION","show","opts","transition","hide","getDuration","state","showDuration","undefined","hideDuration","getDelay","showDelay","hideDelay","deferred","el","resolve","promise","transitionDuration","delay","style","beforeTransition","beforeShow","transitionDelay","applyTransition","showClass","classList","applyAfterTransition","afterHide","doTransition","setTimeout","maybeDelayTransition"],"mappings":"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","file":"transition.js","sourcesContent":["/*\nGeneric show/hide transition module\n*/\n\nimport m from 'mithril';\n\n// defaults\nconst SHOW_DURATION = .220; // default dialog timing\nconst HIDE_DURATION = .200; // default dialog timing\nconst SHOW_DELAY = 0;\nconst HIDE_DELAY = 0;\nconst TRANSITION = 'both';\n\n// See: transition\nconst show = (opts) =>\n    transition(opts, 'show');\n\nconst hide = (opts) =>\n    transition(opts, 'hide');\n\n/*\nopts:\n- transition\n- showDuration\n- hideDuration\n\n- state (show, hide)\n*/\nconst getDuration = (opts, state) => {\n    const transition = opts.transition || TRANSITION;\n    if (transition === 'none') {\n        return 0;\n    } else if (transition === 'show' && state === 'hide') {\n        return 0;\n    } else if (transition === 'hide' && state === 'show') {\n        return 0;\n    } else {\n        // both\n        return (state === 'show') ? (opts.showDuration !== undefined) ? opts.showDuration : SHOW_DURATION : (opts.hideDuration !== undefined) ? opts.hideDuration : HIDE_DURATION;\n    }\n    return 0;\n};\n\n/*\nopts:\n- transition (show, hide, both)\n- showDelay\n- hideDelay\n\n- state (show, hide)\n*/\nconst getDelay = (opts, state) => {\n    const transition = opts.transition || TRANSITION;\n    if (transition === 'none') {\n        return 0;\n    } else if (transition === 'show' && state === 'hide') {\n        return 0;\n    } else if (transition === 'hide' && state === 'show') {\n        return 0;\n    } else {\n        // both\n        return (state === 'show') ? (opts.showDelay !== undefined) ? opts.showDelay : SHOW_DELAY : (opts.hideDelay !== undefined) ? opts.hideDelay : HIDE_DELAY;\n    }\n    return 0;\n};\n\n/*\nopts:\n- el\n- duration\n- delay\n- showClass\n- beforeShow\n- show\n- hide\n- afterHide\n- showDelay\n- hideDelay\n\n- state (show, hide)\n*/\nconst transition = (opts, state) => {\n    const deferred = m.deferred();\n    const el = opts.el;\n    if (!el) {\n        deferred.resolve();\n        return deferred.promise;\n    }\n    const transitionDuration = getDuration(opts, state) * 1000;\n    const delay = getDelay(opts, state) * 1000;\n    const style = el.style;\n    const beforeTransition = (opts.beforeShow && state === 'show')\n        ? () => {\n            style.transitionDuration = '0ms';\n            style.transitionDelay = '0ms';\n            opts.beforeShow();\n        }\n        : null;\n    const applyTransition = () => {\n        style.transitionDuration = transitionDuration + 'ms';\n        style.transitionDelay = delay + 'ms';\n        if (opts.showClass) {\n            el.classList[(state === 'show') ? 'add' : 'remove'](opts.showClass);\n        }\n        if (opts.show && typeof opts.show === 'function' && state === 'show') {\n            opts.show();\n        }\n        if (opts.hide && typeof opts.hide === 'function' && state === 'hide') {\n            opts.hide();\n        }\n    };\n    const applyAfterTransition = () => {\n        if (opts.afterHide && state === 'hide') {\n            style.transitionDuration = '0ms';\n            style.transitionDelay = '0ms';\n            opts.afterHide();\n        }\n    };\n\n    const doTransition = () => {\n        applyTransition();\n        setTimeout(() => {\n            applyAfterTransition();\n            deferred.resolve();\n        }, transitionDuration + delay);\n    };\n\n    const maybeDelayTransition = () => {\n        if (transitionDuration === 0) {\n            doTransition();\n        } else {\n            setTimeout(() => {\n                doTransition();\n            }, 0);\n        }\n    };\n\n    if (beforeTransition) {\n        beforeTransition();\n        setTimeout(() => {\n            maybeDelayTransition();\n        }, 0);\n    } else {\n        maybeDelayTransition();\n    }\n\n    return deferred.promise;\n};\n\nexport default {\n    show,\n    hide\n};\n"]}